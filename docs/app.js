'use strict';var commonjsGlobal="undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{};function createCommonjsModule(k,u){return u={exports:{}},k(u,u.exports),u.exports}
var mithril=createCommonjsModule(function(k){(function(){function u(a,d,f,e,g,w){return{tag:a,key:d,attrs:f,children:e,text:g,dom:w,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}function E(a){for(var d in a)if(H.call(a,d))return!1;return!0}function v(a){var d=arguments[1],f=2;if(null==a||"string"!==typeof a&&"function"!==typeof a&&"function"!==typeof a.view)throw Error("The selector must be either a string or a component.");if("string"===typeof a){var e;if(!(e=Q[a])){var g=
"div";for(var w=[],h={};e=S.exec(a);){var r=e[1],q=e[2];""===r&&""!==q?g=q:"#"===r?h.id=q:"."===r?w.push(q):"["===e[3][0]&&((r=e[6])&&(r=r.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===e[4]?w.push(r):h[e[4]]=""===r?r:r||!0)}0<w.length&&(h.className=w.join(" "));e=Q[a]={tag:g,attrs:h}}}if(null==d)d={};else if("object"!==typeof d||null!=d.tag||Array.isArray(d))d={},f=1;if(arguments.length===f+1)g=arguments[f],Array.isArray(g)||(g=[g]);else for(g=[];f<arguments.length;)g.push(arguments[f++]);
f=u.normalizeChildren(g);if("string"===typeof a){g=!1;var n,p;w=d.className||d.class;if(!E(e.attrs)&&!E(d)){h={};for(var b in d)H.call(d,b)&&(h[b]=d[b]);d=h}for(b in e.attrs)H.call(e.attrs,b)&&(d[b]=e.attrs[b]);void 0!==w&&(void 0!==d.class&&(d.class=void 0,d.className=w),null!=e.attrs.className&&(d.className=e.attrs.className+" "+w));for(b in d)if(H.call(d,b)&&"key"!==b){g=!0;break}Array.isArray(f)&&1===f.length&&null!=f[0]&&"#"===f[0].tag?p=f[0].children:n=f;return u(e.tag,d.key,g?d:void 0,n,p)}return u(a,
d.key,d,f)}function T(a){var d=0,f=null,e="function"===typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var g=Date.now();0===d||16<=g-d?(d=g,a()):null===f&&(f=e(function(){f=null;a();d=Date.now()},16-(g-d)))}}u.normalize=function(a){return Array.isArray(a)?u("[",void 0,void 0,u.normalizeChildren(a),void 0,void 0):null!=a&&"object"!==typeof a?u("#",void 0,void 0,!1===a?"":a,void 0,void 0):a};u.normalizeChildren=function(a){for(var d=0;d<a.length;d++)a[d]=u.normalize(a[d]);
return a};var S=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,Q={},H={}.hasOwnProperty;v.trust=function(a){null==a&&(a="");return u("<",void 0,void 0,a,void 0,void 0)};v.fragment=function(a,d){return u("[",a.key,a,u.normalizeChildren(d),void 0,void 0)};var A=function(a){function d(a,b){return function L(d){var h;try{if(!b||null==d||"object"!==typeof d&&"function"!==typeof d||"function"!==typeof(h=d.then))n(function(){b||0!==a.length||console.error("Possible unhandled promise rejection:",
d);for(var f=0;f<a.length;f++)a[f](d);g.length=0;w.length=0;q.state=b;q.retry=function(){L(d)}});else{if(d===e)throw new TypeError("Promise can't be resolved w/ itself");f(h.bind(d))}}catch(U){r(U)}}}function f(a){function b(b){return function(a){0<d++||b(a)}}var d=0,f=b(r);try{a(b(h),f)}catch(L){f(L)}}if(!(this instanceof A))throw Error("Promise must be called with `new`");if("function"!==typeof a)throw new TypeError("executor must be a function");var e=this,g=[],w=[],h=d(g,!0),r=d(w,!1),q=e._instance=
{resolvers:g,rejectors:w},n="function"===typeof setImmediate?setImmediate:setTimeout;f(a)};A.prototype.then=function(a,d){function f(a,d,f,h){d.push(function(b){if("function"!==typeof a)f(b);else try{g(a(b))}catch(D){w&&w(D)}});"function"===typeof e.retry&&h===e.state&&e.retry()}var e=this._instance,g,w,h=new A(function(a,d){g=a;w=d});f(a,e.resolvers,g,!0);f(d,e.rejectors,w,!1);return h};A.prototype.catch=function(a){return this.then(null,a)};A.resolve=function(a){return a instanceof A?a:new A(function(d){d(a)})};
A.reject=function(a){return new A(function(d,f){f(a)})};A.all=function(a){return new A(function(d,f){var e=a.length,g=0,w=[];if(0===a.length)d([]);else for(var h=0;h<a.length;h++)(function(h){function q(a){g++;w[h]=a;g===e&&d(w)}null==a[h]||"object"!==typeof a[h]&&"function"!==typeof a[h]||"function"!==typeof a[h].then?q(a[h]):a[h].then(q,f)})(h)})};A.race=function(a){return new A(function(d,f){for(var e=0;e<a.length;e++)a[e].then(d,f)})};"undefined"!==typeof window?("undefined"===typeof window.Promise&&
(window.Promise=A),A=window.Promise):"undefined"!==typeof commonjsGlobal&&("undefined"===typeof commonjsGlobal.Promise&&(commonjsGlobal.Promise=A),A=commonjsGlobal.Promise);var I=function(a){function d(a,e){if(Array.isArray(e))for(var g=0;g<e.length;g++)d(a+"["+g+"]",e[g]);else if("[object Object]"===Object.prototype.toString.call(e))for(g in e)d(a+"["+g+"]",e[g]);else f.push(encodeURIComponent(a)+(null!=e&&""!==e?"="+encodeURIComponent(e):""))}if("[object Object]"!==Object.prototype.toString.call(a))return"";
var f=[],e;for(e in a)d(e,a[e]);return f.join("&")},V=/^file:\/\//i,O=function(a,d){function f(){function b(){0===--a&&"function"===typeof p&&p()}var a=0;return function F(d){var f=d.then;d.then=function(){a++;var g=f.apply(d,arguments);g.then(b,function(d){b();if(0===a)throw d;});return F(g)};return d}}function e(b,a){if("string"===typeof b){var d=b;b=a||{};null==b.url&&(b.url=d)}return b}function g(b,a){if(null==a)return b;for(var d=b.match(/:[^\/]+/gi)||[],f=0;f<d.length;f++){var g=d[f].slice(1);
null!=a[g]&&(b=b.replace(d[f],a[g]))}return b}function w(b,a){a=I(a);if(""!==a){var d=0>b.indexOf("?")?"?":"&";b+=d+a}return b}function h(b){try{return""!==b?JSON.parse(b):null}catch(D){throw Error(b);}}function k(b){return b.responseText}function q(b,a){if("function"===typeof b)if(Array.isArray(a))for(var d=0;d<a.length;d++)a[d]=new b(a[d]);else return new b(a);return a}var n=0,p;return{request:function(b,n){var p=f();b=e(b,n);n=new d(function(d,f){null==b.method&&(b.method="GET");b.method=b.method.toUpperCase();
var e="GET"===b.method||"TRACE"===b.method?!1:"boolean"===typeof b.useBody?b.useBody:!0;"function"!==typeof b.serialize&&(b.serialize="undefined"!==typeof FormData&&b.data instanceof FormData?function(b){return b}:JSON.stringify);"function"!==typeof b.deserialize&&(b.deserialize=h);"function"!==typeof b.extract&&(b.extract=k);b.url=g(b.url,b.data);e?b.data=b.serialize(b.data):b.url=w(b.url,b.data);var n=new a.XMLHttpRequest,p=!1,u=n.abort;n.abort=function(){p=!0;u.call(n)};n.open(b.method,b.url,"boolean"===
typeof b.async?b.async:!0,"string"===typeof b.user?b.user:void 0,"string"===typeof b.password?b.password:void 0);b.serialize!==JSON.stringify||!e||b.headers&&b.headers.hasOwnProperty("Content-Type")||n.setRequestHeader("Content-Type","application/json; charset=utf-8");b.deserialize!==h||b.headers&&b.headers.hasOwnProperty("Accept")||n.setRequestHeader("Accept","application/json, text/*");b.withCredentials&&(n.withCredentials=b.withCredentials);for(var r in b.headers)({}).hasOwnProperty.call(b.headers,
r)&&n.setRequestHeader(r,b.headers[r]);"function"===typeof b.config&&(n=b.config(n,b)||n);n.onreadystatechange=function(){if(!p&&4===n.readyState)try{var a=b.extract!==k?b.extract(n,b):b.deserialize(b.extract(n,b));if(200<=n.status&&300>n.status||304===n.status||V.test(b.url))d(q(b.type,a));else{var g=Error(n.responseText),l;for(l in a)g[l]=a[l];f(g)}}catch(c){f(c)}};e&&null!=b.data?n.send(b.data):n.send()});return!0===b.background?n:p(n)},jsonp:function(b,h){var k=f();b=e(b,h);h=new d(function(d,
f){var e=b.callbackName||"_mithril_"+Math.round(1E16*Math.random())+"_"+n++,h=a.document.createElement("script");a[e]=function(f){h.parentNode.removeChild(h);d(q(b.type,f));delete a[e]};h.onerror=function(){h.parentNode.removeChild(h);f(Error("JSONP request failed"));delete a[e]};null==b.data&&(b.data={});b.url=g(b.url,b.data);b.data[b.callbackKey||"callback"]=e;h.src=w(b.url,b.data);a.document.documentElement.appendChild(h)});return!0===b.background?h:k(h)},setCompletionCallback:function(b){p=b}}}(window,
A),R=function(a){function d(l,c,t,b,a,d,g){for(;t<b;t++){var x=c[t];null!=x&&f(l,x,a,g,d)}}function f(l,c,t,b,a){var x=c.tag;if("string"===typeof x)switch(c.state={},null!=c.attrs&&J(c.attrs,c,t),x){case "#":return c.dom=B.createTextNode(c.children),n(l,c.dom,a),c.dom;case "<":return e(l,c,a);case "[":var h=B.createDocumentFragment();null!=c.children&&(x=c.children,d(h,x,0,x.length,t,null,b));c.dom=h.firstChild;c.domSize=h.childNodes.length;n(l,h,a);return h;default:var q=c.tag,k=(x=c.attrs)&&x.is;
q=(b=c.attrs&&c.attrs.xmlns||E[c.tag]||b)?k?B.createElementNS(b,q,{is:k}):B.createElementNS(b,q):k?B.createElement(q,{is:k}):B.createElement(q);c.dom=q;if(null!=x)for(h in k=b,x)v(c,h,null,x[h],k);n(l,q,a);null!=c.attrs&&null!=c.attrs.contenteditable?p(c):(null!=c.text&&(""!==c.text?q.textContent=c.text:c.children=[u("#",void 0,void 0,c.text,void 0,void 0)]),null!=c.children&&(l=c.children,d(q,l,0,l.length,t,null,b),l=c.attrs,"select"===c.tag&&null!=l&&("value"in l&&v(c,"value",null,l.value,void 0),
"selectedIndex"in l&&v(c,"selectedIndex",null,l.selectedIndex,void 0))));return q}else return g(c,t),null!=c.instance?(t=f(l,c.instance,t,b,a),c.dom=c.instance.dom,c.domSize=null!=c.dom?c.instance.domSize:0,n(l,t,a),c=t):(c.domSize=0,c=N),c}function e(l,c,b){var t={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(c.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div";t=B.createElement(t);t.innerHTML=c.children;c.dom=t.firstChild;c.domSize=
t.childNodes.length;c=B.createDocumentFragment();for(var a;a=t.firstChild;)c.appendChild(a);n(l,c,b);return c}function g(l,c){if("function"===typeof l.tag.view){l.state=Object.create(l.tag);var b=l.state.view;if(null!=b.$$reentrantLock$$)return N;b.$$reentrantLock$$=!0}else{l.state=void 0;b=l.tag;if(null!=b.$$reentrantLock$$)return N;b.$$reentrantLock$$=!0;l.state=null!=l.tag.prototype&&"function"===typeof l.tag.prototype.view?new l.tag(l):l.tag(l)}l._state=l.state;null!=l.attrs&&J(l.attrs,l,c);J(l._state,
l,c);l.instance=u.normalize(l._state.view.call(l.state,l));if(l.instance===l)throw Error("A view cannot return the vnode it received as argument");b.$$reentrantLock$$=null}function w(l,c,t,a,g,e,w){if(c!==t&&(null!=c||null!=t))if(null==c)d(l,t,0,t.length,g,e,w);else if(null==t)b(c,0,c.length,t);else{if(c.length===t.length){for(var x=!1,p=0;p<t.length;p++)if(null!=t[p]&&null!=c[p]){x=null==t[p].key&&null==c[p].key;break}if(x){for(p=0;p<c.length;p++)c[p]!==t[p]&&(null==c[p]&&null!=t[p]?f(l,t[p],g,w,
q(c,p+1,e)):null==t[p]?b(c,p,p+1,t):h(l,c[p],t[p],g,q(c,p+1,e),a,w));return}}if(!a)a:{if(null!=c.pool&&Math.abs(c.pool.length-t.length)<=Math.abs(c.length-t.length)&&(a=t[0]&&t[0].children&&t[0].children.length||0,Math.abs((c.pool[0]&&c.pool[0].children&&c.pool[0].children.length||0)-a)<=Math.abs((c[0]&&c[0].children&&c[0].children.length||0)-a))){a=!0;break a}a=!1}if(a){var u=c.pool;c=c.concat(c.pool)}p=x=0;for(var r=c.length-1,z=t.length-1,D;r>=x&&z>=p;){var y=c[x],v=t[p];if(y!==v||a)if(null==y)x++;
else if(null==v)p++;else if(y.key===v.key){var C=null!=u&&x>=c.length-u.length||null==u&&a;x++;p++;h(l,y,v,g,q(c,x,e),C,w);a&&y.tag===v.tag&&n(l,k(y),e)}else if(y=c[r],y!==v||a)if(null==y)r--;else if(null==v)p++;else if(y.key===v.key)C=null!=u&&r>=c.length-u.length||null==u&&a,h(l,y,v,g,q(c,r+1,e),C,w),(a||p<z)&&n(l,k(y),q(c,x,e)),r--,p++;else break;else r--,p++;else x++,p++}for(;r>=x&&z>=p;){y=c[r];v=t[z];if(y!==v||a)if(null==y)r--;else{if(null!=v)if(y.key===v.key)C=null!=u&&r>=c.length-u.length||
null==u&&a,h(l,y,v,g,q(c,r+1,e),C,w),a&&y.tag===v.tag&&n(l,k(y),e),null!=y.dom&&(e=y.dom),r--;else{if(!D){D=c;y=r;C={};var F;for(F=0;F<y;F++){var G=D[F];null!=G&&(G=G.key,null!=G&&(C[G]=F))}D=C}null!=v&&(y=D[v.key],null!=y?(C=c[y],h(l,C,v,g,q(c,r+1,e),a,w),n(l,k(C),e),c[y].skip=!0,null!=C.dom&&(e=C.dom)):e=f(l,v,g,w,e))}z--}else r--,z--;if(z<p)break}d(l,t,p,z+1,g,e,w);b(c,x,r+1,t)}}function h(l,c,a,b,d,n,q){var t=c.tag;if(t===a.tag){a.state=c.state;a._state=c._state;a.events=c.events;var x;if(x=!n){var r,
y;null!=a.attrs&&"function"===typeof a.attrs.onbeforeupdate&&(r=a.attrs.onbeforeupdate.call(a.state,a,c));"string"!==typeof a.tag&&"function"===typeof a._state.onbeforeupdate&&(y=a._state.onbeforeupdate.call(a.state,a,c));void 0===r&&void 0===y||r||y?x=!1:(a.dom=c.dom,a.domSize=c.domSize,a.instance=c.instance,x=!0)}if(!x)if("string"===typeof t)switch(null!=a.attrs&&(n?(a.state={},J(a.attrs,a,b)):M(a.attrs,a,b)),t){case "#":c.children.toString()!==a.children.toString()&&(c.dom.nodeValue=a.children);
a.dom=c.dom;break;case "<":c.children!==a.children?(k(c),e(l,a,d)):(a.dom=c.dom,a.domSize=c.domSize);break;case "[":w(l,c.children,a.children,n,b,d,q);c=0;b=a.children;a.dom=null;if(null!=b){for(n=0;n<b.length;n++){var z=b[n];null!=z&&null!=z.dom&&(null==a.dom&&(a.dom=z.dom),c+=z.domSize||1)}1!==c&&(a.domSize=c)}break;default:l=a.dom=c.dom;q=a.attrs&&a.attrs.xmlns||E[a.tag]||q;"textarea"===a.tag&&(null==a.attrs&&(a.attrs={}),null!=a.text&&(a.attrs.value=a.text,a.text=void 0));d=c.attrs;t=a.attrs;
x=q;if(null!=t)for(z in t)v(a,z,d&&d[z],t[z],x);if(null!=d)for(z in d)null!=t&&z in t||("className"===z&&(z="class"),"o"!==z[0]||"n"!==z[1]||F(z)?"key"!==z&&a.dom.removeAttribute(z):A(a,z,void 0));null!=a.attrs&&null!=a.attrs.contenteditable?p(a):null!=c.text&&null!=a.text&&""!==a.text?c.text.toString()!==a.text.toString()&&(c.dom.firstChild.nodeValue=a.text):(null!=c.text&&(c.children=[u("#",void 0,void 0,c.text,void 0,c.dom.firstChild)]),null!=a.text&&(a.children=[u("#",void 0,void 0,a.text,void 0,
void 0)]),w(l,c.children,a.children,n,b,null,q))}else{if(n)g(a,b);else{a.instance=u.normalize(a._state.view.call(a.state,a));if(a.instance===a)throw Error("A view cannot return the vnode it received as argument");null!=a.attrs&&M(a.attrs,a,b);M(a._state,a,b)}null!=a.instance?(null==c.instance?f(l,a.instance,b,q,d):h(l,c.instance,a.instance,b,d,n,q),a.dom=a.instance.dom,a.domSize=a.instance.domSize):null!=c.instance?(D(c.instance,null),a.dom=void 0,a.domSize=0):(a.dom=c.dom,a.domSize=c.domSize)}}else D(c,
null),f(l,a,b,q,d)}function k(a){var c=a.domSize;if(null!=c||null==a.dom){var b=B.createDocumentFragment();if(0<c){for(a=a.dom;--c;)b.appendChild(a.nextSibling);b.insertBefore(a,b.firstChild)}return b}return a.dom}function q(a,c,b){for(;c<a.length;c++)if(null!=a[c]&&null!=a[c].dom)return a[c].dom;return b}function n(a,c,b){b&&b.parentNode?a.insertBefore(c,b):a.appendChild(c)}function p(a){var c=a.children;if(null!=c&&1===c.length&&"<"===c[0].tag)c=c[0].children,a.dom.innerHTML!==c&&(a.dom.innerHTML=
c);else if(null!=a.text||null!=c&&0!==c.length)throw Error("Child node of a contenteditable must be trusted");}function b(a,c,b,d){for(;c<b;c++){var l=a[c];null!=l&&(l.skip?l.skip=!1:D(l,d))}}function D(a,c){function b(){if(++d===l&&(G(a),a.dom)){var b=a.domSize||1;if(1<b)for(var e=a.dom;--b;){var g=e.nextSibling,f=g.parentNode;null!=f&&f.removeChild(g)}b=a.dom;e=b.parentNode;null!=e&&e.removeChild(b);if(b=null!=c&&null==a.domSize)b=a.attrs,b=!(null!=b&&(b.oncreate||b.onupdate||b.onbeforeremove||
b.onremove));b&&"string"===typeof a.tag&&(c.pool?c.pool.push(a):c.pool=[a])}}var l=1,d=0;if(a.attrs&&"function"===typeof a.attrs.onbeforeremove){var e=a.attrs.onbeforeremove.call(a.state,a);null!=e&&"function"===typeof e.then&&(l++,e.then(b,b))}"string"!==typeof a.tag&&"function"===typeof a._state.onbeforeremove&&(e=a._state.onbeforeremove.call(a.state,a),null!=e&&"function"===typeof e.then&&(l++,e.then(b,b)));b()}function G(a){a.attrs&&"function"===typeof a.attrs.onremove&&a.attrs.onremove.call(a.state,
a);if("string"!==typeof a.tag)"function"===typeof a._state.onremove&&a._state.onremove.call(a.state,a),null!=a.instance&&G(a.instance);else if(a=a.children,Array.isArray(a))for(var b=0;b<a.length;b++){var d=a[b];null!=d&&G(d)}}function v(a,b,d,e,g){var c=a.dom;if("key"!==b&&"is"!==b&&(d!==e||"value"===b||"checked"===b||"selectedIndex"===b||"selected"===b&&a.dom===B.activeElement||"object"===typeof e)&&"undefined"!==typeof e&&!F(b)){var l=b.indexOf(":");if(-1<l&&"xlink"===b.substr(0,l))c.setAttributeNS("http://www.w3.org/1999/xlink",
b.slice(l+1),e);else if("o"===b[0]&&"n"===b[1]&&"function"===typeof e)A(a,b,e);else if("style"===b)if(a=d,a===e&&(c.style.cssText="",a=null),null==e)c.style.cssText="";else if("string"===typeof e)c.style.cssText=e;else{"string"===typeof a&&(c.style.cssText="");for(var f in e)c.style[f]=e[f];if(null!=a&&"string"!==typeof a)for(f in a)f in e||(c.style[f]="")}else if(b in c&&"href"!==b&&"list"!==b&&"form"!==b&&"width"!==b&&"height"!==b&&void 0===g&&!(a.attrs.is||-1<a.tag.indexOf("-"))){if("value"===
b){f=""+e;if(("input"===a.tag||"textarea"===a.tag)&&a.dom.value===f&&a.dom===B.activeElement)return;if("select"===a.tag)if(null===e){if(-1===a.dom.selectedIndex&&a.dom===B.activeElement)return}else if(null!==d&&a.dom.value===f&&a.dom===B.activeElement)return;if("option"===a.tag&&null!=d&&a.dom.value===f)return}"input"===a.tag&&"type"===b?c.setAttribute(b,e):c[b]=e}else"boolean"===typeof e?e?c.setAttribute(b,""):c.removeAttribute(b):c.setAttribute("className"===b?"class":b,e)}}function F(a){return"oninit"===
a||"oncreate"===a||"onupdate"===a||"onremove"===a||"onbeforeremove"===a||"onbeforeupdate"===a}function A(a,b,d){var c=a.dom,e="function"!==typeof H?d:function(a){var b=d.call(c,a);H.call(c,a);return b};if(b in c)c[b]="function"===typeof d?e:null;else{var l=b.slice(2);void 0===a.events&&(a.events={});a.events[b]!==e&&(null!=a.events[b]&&c.removeEventListener(l,a.events[b],!1),"function"===typeof d&&(a.events[b]=e,c.addEventListener(l,a.events[b],!1)))}}function J(a,b,d){"function"===typeof a.oninit&&
a.oninit.call(b.state,b);"function"===typeof a.oncreate&&d.push(a.oncreate.bind(b.state,b))}function M(a,b,d){"function"===typeof a.onupdate&&d.push(a.onupdate.bind(b.state,b))}var B=a.document,N=B.createDocumentFragment(),E={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},H;return{render:function(a,b){if(!a)throw Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var c=[],d=B.activeElement,e=a.namespaceURI;null==a.vnodes&&(a.textContent=
"");Array.isArray(b)||(b=[b]);w(a,a.vnodes,u.normalizeChildren(b),!1,c,null,"http://www.w3.org/1999/xhtml"===e?void 0:e);a.vnodes=b;null!=d&&B.activeElement!==d&&d.focus();for(a=0;a<c.length;a++)c[a]()},setEventCallback:function(a){return H=a}}},K=function(a){function d(a){a=e.indexOf(a);-1<a&&e.splice(a,2)}function f(){for(var a=1;a<e.length;a+=2)e[a]()}a=R(a);a.setEventCallback(function(a){!1===a.redraw?a.redraw=void 0:f()});var e=[];return{subscribe:function(a,f){d(a);e.push(a,T(f))},unsubscribe:d,
redraw:f,render:a.render}}(window);O.setCompletionCallback(K.redraw);v.mount=function(a){return function(d,f){if(null===f)a.render(d,[]),a.unsubscribe(d);else{if(null==f.view&&"function"!==typeof f)throw Error("m.mount(element, component) expects a component, not a vnode");a.subscribe(d,function(){a.render(d,u(f))});a.redraw()}}}(K);var W=A,P=function(a){if(""===a||null==a)return{};"?"===a.charAt(0)&&(a=a.slice(1));a=a.split("&");for(var d={},f={},e=0;e<a.length;e++){var g=a[e].split("="),k=decodeURIComponent(g[0]);
g=2===g.length?decodeURIComponent(g[1]):"";"true"===g?g=!0:"false"===g&&(g=!1);var h=k.split(/\]\[?|\[/),r=d;-1<k.indexOf("[")&&h.pop();for(var q=0;q<h.length;q++){k=h[q];var n=h[q+1];n=""==n||!isNaN(parseInt(n,10));var p=q===h.length-1;""===k&&(k=h.slice(0,q).join(),null==f[k]&&(f[k]=0),k=f[k]++);null==r[k]&&(r[k]=p?g:n?[]:{});r=r[k]}}return d},X=function(a){function d(d){var e=a.location[d].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);"pathname"===d&&"/"!==e[0]&&(e="/"+e);return e}function f(a){return function(){null==
h&&(h=k(function(){h=null;a()}))}}function e(a,d,e){var b=a.indexOf("?"),f=a.indexOf("#"),g=-1<b?b:-1<f?f:a.length;if(-1<b){b=P(a.slice(b+1,-1<f?f:a.length));for(var h in b)d[h]=b[h]}if(-1<f)for(h in d=P(a.slice(f+1)),d)e[h]=d[h];return a.slice(0,g)}var g="function"===typeof a.history.pushState,k="function"===typeof setImmediate?setImmediate:setTimeout,h,r={prefix:"#!",getPath:function(){switch(r.prefix.charAt(0)){case "#":return d("hash").slice(r.prefix.length);case "?":return d("search").slice(r.prefix.length)+
d("hash");default:return d("pathname").slice(r.prefix.length)+d("search")+d("hash")}},setPath:function(d,f,h){var b={},k={};d=e(d,b,k);if(null!=f){for(var p in f)b[p]=f[p];d=d.replace(/:([^\/]+)/g,function(a,d){delete b[d];return f[d]})}(p=I(b))&&(d+="?"+p);(k=I(k))&&(d+="#"+k);g?(k=h?h.state:null,p=h?h.title:null,a.onpopstate(),h&&h.replace?a.history.replaceState(k,p,r.prefix+d):a.history.pushState(k,p,r.prefix+d)):a.location.href=r.prefix+d},defineRoutes:function(d,h,k){function b(){var b=r.getPath(),
f={},g=e(b,f,f),p=a.history.state;if(null!=p)for(var n in p)f[n]=p[n];for(var q in d)if(p=new RegExp("^"+q.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$"),p.test(g)){g.replace(p,function(){for(var a=q.match(/:[^\/]+/g)||[],e=[].slice.call(arguments,1,-2),g=0;g<a.length;g++)f[a[g].replace(/:|\./g,"")]=decodeURIComponent(e[g]);h(d[q],f,b,q)});return}k(b,f)}g?a.onpopstate=f(b):"#"===r.prefix.charAt(0)&&(a.onhashchange=b);b()}};return r};v.route=function(a,d){var f=X(a),e=function(a){return a},
g,k,h,r,q,n=function(a,b,n){if(null==a)throw Error("Ensure the DOM element that was passed to `m.route` is not undefined");var p=function(){null!=g&&d.render(a,g(u(k,h.key,h)))},v=function(a){if(a!==b)f.setPath(b,null,{replace:!0});else throw Error("Could not resolve default route "+b);};f.defineRoutes(n,function(a,b,d){var f=q=function(a,n){f===q&&(k=null==n||"function"!==typeof n.view&&"function"!==typeof n?"div":n,h=b,r=d,q=null,g=(a.render||e).bind(a),p())};a.view||"function"===typeof a?f({},
a):a.onmatch?W.resolve(a.onmatch(b,d)).then(function(b){f(a,b)},v):f(a,"div")},v);d.subscribe(a,p)};n.set=function(a,b,d){null!=q&&(d=d||{},d.replace=!0);q=null;f.setPath(a,b,d)};n.get=function(){return r};n.prefix=function(a){f.prefix=a};n.link=function(a){a.dom.setAttribute("href",f.prefix+a.attrs.href);a.dom.onclick=function(a){a.ctrlKey||a.metaKey||a.shiftKey||2===a.which||(a.preventDefault(),a.redraw=!1,a=this.getAttribute("href"),0===a.indexOf(f.prefix)&&(a=a.slice(f.prefix.length)),n.set(a,
void 0,void 0))}};n.param=function(a){return"undefined"!==typeof h&&"undefined"!==typeof a?h[a]:h};return n}(window,K);v.withAttr=function(a,d,f){return function(e){d.call(f||this,a in e.currentTarget?e.currentTarget[a]:e.currentTarget.getAttribute(a))}};var Y=R(window);v.render=Y.render;v.redraw=K.redraw;v.request=O.request;v.jsonp=O.jsonp;v.parseQueryString=P;v.buildQueryString=I;v.version="1.1.6";v.vnode=u;k.exports=v})()});
function styleInject(k,u){void 0===u&&(u={});u=u.insertAt;if(k&&"undefined"!==typeof document){var E=document.head||document.getElementsByTagName("head")[0],v=document.createElement("style");v.type="text/css";"top"===u?E.firstChild?E.insertBefore(v,E.firstChild):E.appendChild(v):E.appendChild(v);v.styleSheet?v.styleSheet.cssText=k:v.appendChild(document.createTextNode(k))}}var css='body {\r\n    padding: 1em;\r\n}\r\n\r\n.container {\r\n    width: 80%;\r\n    max-width: 800px;\r\n    margin: auto;\r\n}\r\n\r\n.card {\r\n    padding: 0.5em;\r\n}\r\n\r\n.listview {\r\n    overflow-y: scroll;\r\n    height: 60%;\r\n    margin-bottom: 0.5em;\r\n}\r\n\r\n.loading {\r\n    position: relative;\r\n}\r\n\r\n.loading:after {\r\n    left: 40%;\r\n    position: absolute;\r\n    content: "";\r\n    animation: loading-animation 1s linear infinite;\r\n    height: 1.2em;\r\n    width: 1.2em;\r\n    border: 3px dashed whitesmoke;\r\n    border-radius: 50%;\r\n    z-index: 1;\r\n    animation-fill-mode: forwards;\r\n}\r\n\r\n@keyframes loading-animation {\r\n    0% {\r\n        transform: rotate(0deg);\r\n    }\r\n    100% {\r\n        transform: rotate(360deg);\r\n    }\r\n}';
styleInject(css);let log=console.log;
class Model{constructor(){this.id=+new Date;this.host="wss://echo.websocket.org";this.socket=null;this.status="Disconnected";this.messages=[];this.line="";this.isConnecting=!1}connect(){try{log("Connecting to ",this.host),this.isConnecting=!0,this.socket=new WebSocket(this.host),this.socket.onerror=(k)=>{this.status="Disconnected";log("Error",k);this.socket=null},this.socket.onclose=(k)=>{this.status="Closed";this.socket=null},this.socket.onmessage=(k)=>this.onMessage(k),this.socket.onopen=(k)=>{try{this.isConnecting=
!1,this.status="Connected",m.route.set("/socket")}catch(u){log("Error On Open",u)}}}catch(k){log("Error",k)}}send(k){this.addMessage("You",k);this.socket.send(k)}onMessage(k){try{this.addMessage("Server",k.data),k.preventDefault()}catch(u){log("Error",u)}}close(){this.socket&&this.socket.close();this.messages=[];m.route.set("/")}addMessage(k,u){this.messages||(this.messages=[]);this.messages.push(k+": "+JSON.stringify(u));m.redraw()}}var model$1=new Model;
function Connect(k){13===k&&model.connect()}class ConnectScreen{constructor(k){}view(){return m("div",{class:"card"},m("header",null,m("h3",null,"Connect")),m("input",{value:model.host,oninput:m.withAttr("value",(k)=>model.host=k),onkeypress:(k)=>Connect(k.charCode)}),m("footer",null,m("button",{onclick:()=>model.connect(),class:model.isConnecting?"loading":""},"Connect")))}}
let sendLineOnKeyPress=(k)=>{13===k.charCode&&sendLine()},sendLine=()=>{model.send(model.line);model.line=""},scrollToBottom=(k)=>{k.dom.scrollTop=k.dom.scrollHeight};
class ClientScreen{constructor(){model.socket||m.route.set("/")}view(){return m("article",{class:"card"},m("header",null,m("h3",null,"Client: ",model.status)),m(".listview",{onupdate:(k)=>scrollToBottom(k)},model.messages.map((k)=>m("p.stack",k))),m("input",{value:model.line,oninput:m.withAttr("value",(k)=>model.line=k),onkeypress:(k)=>sendLineOnKeyPress(k),autofocus:!0}),m("footer",null,m("button",{onclick:()=>sendLine()},"Send"),m("button",{class:"dangerous",onclick:()=>model.close()},"Back")))}}
window.model=model$1;window.m=mithril;mithril.route(root,"/",{"/":ConnectScreen,"/socket":ClientScreen});
